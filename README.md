# Накопительная система лояльности "Гофермарт"

## Общее описание

Система представляет собой HTTP API для управления накопительной системой лояльности "Гофермарт". Основные функции системы включают в себя регистрацию пользователей, аутентификацию, учет заказов и начисление баллов лояльности.

## Абстрактная схема взаимодействия

1. Пользователь регистрируется в системе лояльности "Гофермарт".
2. Пользователь совершает покупку в интернет-магазине "Гофермарт".
3. Заказ попадает в систему расчёта баллов лояльности.
4. Пользователь передает номер совершенного заказа в систему лояльности.
5. Система связывает номер заказа с пользователем и проверяет его через систему расчёта баллов лояльности.
6. При наличии положительного расчёта баллов производится начисление их на счет пользователя.
7. Пользователь может использовать баллы для оплаты последующих заказов в интернет-магазине "Гофермарт".

## Система расчёта баллов лояльности

Система расчёта баллов лояльности является внешним сервисом с закрытым кодом. Она рассчитывает баллы за заказы по сложным алгоритмам.

## Сводное HTTP API

Система предоставляет следующие HTTP-хендлеры:

- `POST /api/user/register` — регистрация пользователя;
- `POST /api/user/login` — аутентификация пользователя;
- `POST /api/user/orders` — передача номера заказа для расчета;
- `GET /api/user/orders` — получение списка заказов и информации о начислениях;
- `GET /api/user/balance` — получение баланса баллов лояльности;
- `POST /api/user/balance/withdraw` — списание баллов для оплаты заказа;
- `GET /api/user/withdrawals` — получение информации о выводе средств с баланса.

## Общие ограничения и требования

- **Хранилище данных:** PostgreSQL.
- **Структура таблиц:** на усмотрение студента.
- **Типы и формат хранения данных:** на усмотрение студента, включая пароли и другую чувствительную информацию.
- **Поддержка HTTP-запросов/ответов с сжатием данных:** обязательна.
- **Спецификация API:** клиент не обязан следовать предложенной спецификации API, проверка запросов остается на усмотрение студента.
- **Формат и алгоритм проверки аутентификации и авторизации пользователя:** на усмотрение студента.
- **Уникальность номеров заказов:** номера заказов должны быть уникальны и никогда не повторяться.
- **Обработка номеров заказов:** каждый номер заказа может быть принят в обработку только один раз от одного пользователя.
- **Начисление и траты баллов лояльности:** баллы начисляются и тратятся в виртуальных баллах по курсу 1 балл = 1 единица местной валюты.


