# Накопительная система лояльности "Гофермарт"

## Общее описание

Система представляет собой HTTP API для управления накопительной системой лояльности "Гофермарт". Основные функции системы включают в себя регистрацию пользователей, аутентификацию, учет заказов и начисление баллов лояльности.

## Абстрактная схема взаимодействия

1. Пользователь регистрируется в системе лояльности "Гофермарт".
2. Пользователь совершает покупку в интернет-магазине "Гофермарт".
3. Заказ попадает в систему расчёта баллов лояльности.
4. Пользователь передает номер совершенного заказа в систему лояльности.
5. Система связывает номер заказа с пользователем и проверяет его через систему расчёта баллов лояльности.
6. При наличии положительного расчёта баллов производится начисление их на счет пользователя.
7. Пользователь может использовать баллы для оплаты последующих заказов в интернет-магазине "Гофермарт".

## Система расчёта баллов лояльности

Система расчёта баллов лояльности является внешним сервисом с закрытым кодом. Она рассчитывает баллы за заказы по сложным алгоритмам.

## Сводное HTTP API

Система предоставляет следующие HTTP-хендлеры:

- `POST /api/user/register` — регистрация пользователя;
- `POST /api/user/login` — аутентификация пользователя;
- `POST /api/user/orders` — передача номера заказа для расчета;
- `GET /api/user/orders` — получение списка заказов и информации о начислениях;
- `GET /api/user/balance` — получение баланса баллов лояльности;
- `POST /api/user/balance/withdraw` — списание баллов для оплаты заказа;
- `GET /api/user/withdrawals` — получение информации о выводе средств с баланса.

## Ограничения и требования

- Хранилище данных: PostgreSQL.
- Структура таблиц и формат хранения данных остаются на усмотрение студента.
- Номера заказов уникальны и никогда не повторяются.
- Вознаграждение начисляется и тратится в виртуальных баллах.

## Примеры запросов

```bash
# Регистрация пользователя
curl -X POST http://example.com/api/user/register -d '{"username": "user1", "password": "password1"}'

# Аутентификация пользователя
curl -X POST http://example.com/api/user/login -d '{"username": "user1", "password": "password1"}'

# Загрузка номера заказа
curl -X POST http://example.com/api/user/orders -d '{"order_number": "123456"}'
